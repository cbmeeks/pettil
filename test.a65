; test.a65
;#include cbm.def
;#include pettil.def

;====BASIC====
#define		basic		$0400
		.word basic+1			; this will be the load address
*		= basic+1

		.word basend
		.word 10
		.byt $9e			; SYS token
		.asc "1037",0			; $040f
basend		.word 0

l1037		lda #10
		sta base
		jsr tryit
		lda #16
		sta base
		jsr tryit
		lda #8
		sta base
		jsr tryit
		lda #36
		sta base
		jsr tryit
		lda #2
		sta base
		jsr tryit
		rts

		
tryit		lda #'0'
		jsr asc2bin1
		lda #'1'
		jsr asc2bin1
		lda #'2'
		jsr asc2bin1
		lda #'7'
		jsr asc2bin1
		lda #'8'
		jsr asc2bin1
		lda #'9'
		jsr asc2bin1
		lda #'A'
		jsr asc2bin1
		lda #'F'
		jsr asc2bin1
		lda #'H'
		jsr asc2bin1
		lda #'M'
		jsr asc2bin1
		lda #'Z'
		jsr asc2bin1

		lda #'!'
		jsr asc2bin1
		lda #'?'
		jsr asc2bin1
		lda #'@'
		jsr asc2bin1
		lda #'['
		jsr asc2bin1
		rts

asc2bin1	sec
		sbc #$3a
		bpl skip
		sbc #7
skip		bmi bad
		cmp base
		bpl bad
		sta num
		.byt $24
bad		inx
		ora #$7f
		bmi neg
		lda #0
neg		eor #$ff
		tay
		sta flag
		sty flag+1
good		rts
		
base		.byt 0
num		.byt 0
flag		.word $dead
