; pettil.def
#echo .       pettil.def                Symbols only -- PETTIL Zero page

; bitmasks
bit7        =   $80     ; marks first/last bytes of name field
bit6        =   $40     ; immediate
bit5        =   $20     ; smudge

; zero page usage

; Sweet16 registers
;
;00-1f  R0-R15

; PETTIL registers (overlaps Sweet16)
;
up      =       $02     ; user area pointer (1 cell)
zi      =       $04     ; innermost DO LOOP counter (1 cell)
zlim    =       $06     ; innermost DO LOOP limit (1 cell)
tos     =       $08     ; top of stack (1 cell)     -] adjacent, required
n       =       $0a     ; N scratch area (22 bytes)  -] for (?DO) to work
                        ; the zero page memory from $0a-$1f is available
                        ; for primitives, and may be populated from the
                        ; data stack by 'ldy #elements; jsr locals'

; PETTIL stack, split into low byte/high byte sections
;
stackl  =       $20
;stackh  =       stackl+$33      ; (was 51 cells without random numbers)
stackh  =       stackl+$30      ; (48 cells)
bos     =       stackh-stackl
rnd     =       stackh+bos      ; (6 bytes)

; PETTIL NEXT routine
;next   inc ip
;       inc ip
;nexto  jmp ($cafe)
next    =       stackh+bos+6
nexto   =       next+4
ip      =       next+5

; Kernel zeropage area
;
;8d-ff

storex  = $ff       ; unused zeropage for temporary stashing X register
